<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Approval Dashboard</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link 
      rel="stylesheet" 
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />


    <!-- ‡∏¢‡πâ‡∏≤‡∏¢ executive.css ‡∏°‡∏≤‡πÑ‡∏ß‡πâ‡πÉ‡∏ô <style> -->
    <style>
      body {
        margin: 0;
        font-family: Arial, sans-serif;
        background-color: #f5f5f5;
      }
      .container {
        display: flex;
        /* height: 100vh; ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î */
      }

      .notification-btn {
        position: relative;
        display: inline-block;
        color: white;
        padding: 10px 20px;
        border-radius: 5px;
        font-size: 16px;
        font-family: Arial, sans-serif;
      }
      .notification-badge {
        position: absolute;
        top: -5px;
        right: -5px;
        background-color: red;
        color: white;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        font-weight: bold;
        border: 2px solid white;
      }

      .main-content {
        margin-left: 20%;
        margin-top: 3%;
        margin-bottom: 5%;
        flex: 1;
        padding: 20px;
        padding-top: 2px;
        background-color: #e8e8e8;
        border-radius: 10px;
      }

      .tab-bar {
        display: flex;
        padding: 10px;
        justify-content: flex-start;
        align-items: center;
        gap: 10px;
      }
      .tab {
        padding: 15px 20px;
        cursor: pointer;
        font-weight: bold;
        color: #555;
        text-align: center;
      }
      .tab.active {
        color: #000;
        border-bottom: 2px solid #000;
      }
      .tab-bar button.active {
        background-color: #f5f5f5;
        border: 1px solid #ccc;
        font-weight: bold;
      }

      table {
        width: 100%;
        border-collapse: collapse;
      }
      th {
        text-align: center;
        padding: 10px;
        border-bottom: 1px solid #ddd;
      }
      td {
        text-align: center;
      }

      .actions {
        display: flex;
        gap: 10px;
      }
      .actions button {
        padding: 5px 10px;
        border: none;
        cursor: pointer;
        border-radius: 5px;
      }
      .actions2 {
        text-align: center;
        gap: 10px;
      }
      .actions2 button {
        padding: 5px 10px;
        border: none;
        cursor: pointer;
        border-radius: 5px;
      }

      .approve {
        background-color: #4caf50;
        color: white;
      }
      .reject {
        background-color: #ff0606;
        color: white;
      }
      .icon-button {
        display: flex;
        align-items: center;
        gap: 5px;
      }
      .receive {
        justify-content: center;
      }
      .tab a {
        text-decoration: none;
        color: inherit;
      }

      .dropdown-container {
        display: inline-block;
        position: relative;
        font-family: Arial, sans-serif;
        margin-left: auto;
      }
       
      select {
        width: 135px;
        padding: 10px;
        font-size: 14px;
        color: #7e7e7e;
        border: 1px solid #e7e7e7;
        border-radius: 8px;
        background-color: #f9fbff;
        outline: none;
        cursor: pointer;
      }
      select:focus {
        border-color: #aaa;
      }

      /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ Sidebar Responsive */
      @media (max-width: 992px) {
        .main-content {
          margin-left: 0;
          margin-top: 120px; /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ sidebar ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
        }
      }
    </style>
  </head>
  <body>
    <div class="container-fluid">
      <div id="sidebar-container"></div>
      <div class="main-content">
        <div class="tab-bar">
          <div class="tab">
            <a href="booking_rooms_requests.html">‡∏Ñ‡∏≥‡∏Ç‡∏≠</a>
          </div>
          <div class="tab active"><a href="#">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</a></div>
          <div class="tab">
            <a href="not_accept_requests_booking_rooms.html">‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</a>
          </div>
          <div class="dropdown-container">
            <select id="sorttime">
              <option value="oldest">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</option>
              <option value="newest">‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</option>
            </select>
          </div>
        </div>

        <!-- ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ .table-responsive -->
        <div class="table-responsive">
          <table class="table">
            <thead>
              <tr>
                <th style="color: #929292">
                  ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
                  <i
                    class="bi bi-caret-down-fill"
                    style="
                      margin-left: 5px;
                      cursor: pointer;
                      color: #929292;
                      font-size: 10px;
                    "
                    onclick="toggleCalendar()"
                  ></i>
                </th>
                <div
                  id="dropdown-calendar"
                  style="
                    display: none;
                    position: absolute;
                    background: white;
                    box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
                    border-radius: 5px;
                    padding: 10px;
                  "
                >
                  <div
                    style="
                      display: flex;
                      justify-content: space-between;
                      margin-bottom: 10px;
                    "
                  >
                    <select
                      id="month-select"
                      onchange="renderCustomCalendar()"
                    ></select>
                    <select
                      id="year-select"
                      onchange="renderCustomCalendar()"
                    ></select>
                  </div>
                  <div id="custom-calendar"></div>
                </div>

                <script>
                  const currentDate = new Date();

                  function toggleCalendar() {
                    const calendar =
                      document.getElementById("dropdown-calendar");
                    if (
                      calendar.style.display === "none" ||
                      calendar.style.display === ""
                    ) {
                      calendar.style.display = "block";
                      initializeCalendar();
                    } else {
                      calendar.style.display = "none";
                    }
                  }

                  document.addEventListener("click", function (event) {
                    const calendar =
                      document.getElementById("dropdown-calendar");
                    const iconElement = document.querySelector(
                      "i.bi-caret-down-fill"
                    );
                    if (
                      !calendar.contains(event.target) &&
                      event.target !== iconElement
                    ) {
                      calendar.style.display = "none";
                    }
                  });

                  function initializeCalendar() {
                    const monthSelect = document.getElementById("month-select");
                    const yearSelect = document.getElementById("year-select");

                    // Populate months
                    monthSelect.innerHTML = "";
                    const monthNames = [
                      "January",
                      "February",
                      "March",
                      "April",
                      "May",
                      "June",
                      "July",
                      "August",
                      "September",
                      "October",
                      "November",
                      "December",
                    ];
                    monthNames.forEach((month, index) => {
                      const option = document.createElement("option");
                      option.value = index;
                      option.text = month;
                      if (index === currentDate.getMonth())
                        option.selected = true;
                      monthSelect.appendChild(option);
                    });

                    // Populate years
                    yearSelect.innerHTML = "";
                    const startYear = currentDate.getFullYear() - 10;
                    const endYear = currentDate.getFullYear() + 50;
                    for (let year = startYear; year <= endYear; year++) {
                      const option = document.createElement("option");
                      option.value = year;
                      option.text = year;
                      if (year === currentDate.getFullYear())
                        option.selected = true;
                      yearSelect.appendChild(option);
                    }

                    renderCustomCalendar();
                  }

                  function renderCustomCalendar() {
                    const calendarDiv =
                      document.getElementById("custom-calendar");
                    calendarDiv.innerHTML = ""; // Clear existing

                    const selectedMonth = parseInt(
                      document.getElementById("month-select").value
                    );
                    const selectedYear = parseInt(
                      document.getElementById("year-select").value
                    );

                    const daysInMonth = new Date(
                      selectedYear,
                      selectedMonth + 1,
                      0
                    ).getDate();
                    const firstDay = new Date(
                      selectedYear,
                      selectedMonth,
                      1
                    ).getDay();

                    const calendarTable = document.createElement("table");
                    calendarTable.style.borderCollapse = "collapse";
                    calendarTable.style.width = "100%";

                    const headerRow = document.createElement("tr");
                    ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"].forEach(
                      (day) => {
                        const th = document.createElement("th");
                        th.style.textAlign = "center";
                        th.innerText = day;
                        headerRow.appendChild(th);
                      }
                    );
                    calendarTable.appendChild(headerRow);

                    let date = 1;
                    for (let i = 0; i < 6; i++) {
                      const row = document.createElement("tr");
                      for (let j = 0; j < 7; j++) {
                        const cell = document.createElement("td");
                        cell.style.textAlign = "center";
                        cell.style.padding = "5px";
                        cell.style.border = "1px solid #ddd";
                        if (i === 0 && j < firstDay) {
                          cell.innerText = "";
                        } else if (date > daysInMonth) {
                          break;
                        } else {
                          cell.innerText = date;
                          cell.style.cursor = "pointer";
                          cell.onclick = function () {
                            document.getElementById(
                              "dropdown-calendar"
                            ).style.display = "none";
                          };
                          date++;
                        }
                        row.appendChild(cell);
                      }
                      calendarTable.appendChild(row);
                    }
                    calendarDiv.appendChild(calendarTable);
                  }
                </script>
                <th style="color: #929292">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                <th style="color: #929292">
                  ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
                  <div class="dropdown d-inline">
                    <i
                      class="bi bi-caret-down-fill"
                      type="button"
                      data-bs-toggle="dropdown"
                      aria-expanded="false"
                      style="color: #929292; font-size: 10px"
                    ></i>
                    <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="#" onclick="filterTableRole('‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î')">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</a></li>
                      <li><a class="dropdown-item" href="#" onclick="filterTableRole('‡∏ô‡∏¥‡∏™‡∏¥‡∏ï')">‡∏ô‡∏¥‡∏™‡∏¥‡∏ï</a></li>
                      <li><a class="dropdown-item" href="#" onclick="filterTableRole('‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå')">‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå</a></li>
                    </ul>
                  </div>
                </th>
                <th style="color: #929292">
                  ‡∏´‡πâ‡∏≠‡∏á
                  <div class="dropdown d-inline">
                    <i
                      class="bi bi-caret-down-fill"
                      type="button"
                      data-bs-toggle="dropdown"
                      aria-expanded="false"
                      style="color: #929292; font-size: 10px"
                    ></i>
                    <ul class="dropdown-menu" id="roomDropdownMenu"></ul>
                  </div>  
                </th>
                    <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="#" onclick="filterTableRoom('‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î')">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</a></li>
                      <li><a class="dropdown-item" href="#" onclick="filterTableRoom('307')">307</a></li>
                      <li><a class="dropdown-item" href="#" onclick="filterTableRoom('414')">414</a></li>
                    </ul>
                  </div>
                </th>
                <th style="color: #929292">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏¥‡∏™‡∏¥‡∏ï(‡∏Ñ‡∏ô)</th>
                <th style="color: #929292">‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏≠‡∏á</th>
                <th style="color: #929292">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</th>
              </tr>
            </thead>
            <tbody id="reservation-table">
              <!-- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
              <script>

                const today = new Date();
                today.setHours(0, 0, 0, 0); // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏´‡πâ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà


                async function fetchData() {
                try {
                    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å 2 API ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô
                    const [roomsResponse, studentsResponse ,TeacherResponse,participantResponse] = await Promise.all([
                        fetch('http://localhost:3000/room_request'),
                        fetch('http://localhost:3000/student'),
                        fetch('http://localhost:3000/teacher'),
                        fetch('http://localhost:3000/room_request_participant')
                        
                    ])
            
                    const roomsData = await roomsResponse.json();
                    const studentsData = await studentsResponse.json();
                    const TeacherData = await TeacherResponse.json();
                    const participantData = await participantResponse.json();
                    //console.log(TeacherData);
                    // JOIN ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ Student_ID
                    const filteredData = roomsData.filter(row => row.request_status === '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥' && row.request_type === '‡∏ô‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤');

                    const participantCountMap = participantData.reduce((acc, participant) => {
                      acc[participant.room_request_id] = (acc[participant.room_request_id] || 0) + 1;
                      return acc;
                  }, {});
      
                  console.log("üìå ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏ï‡πà‡∏≠ room_request_id:", participantCountMap);
                    
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ñ‡πâ‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß
                    for (const row of filteredData) {
                      const requestDate = new Date(row.used_date);
                      requestDate.setHours(0, 0, 0, 0);

                    if (requestDate < today) {
                          await updateStatus(row.room_request_id, '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥');
                      }
                  }

                      const mergedData = filteredData.map(room => {
                      const student = studentsData.find(s => s.student_id === room.student_id) || {};
                      const Teacher = TeacherData.find(T => T.teacher_id === room.teacher_id) || {};
                      
                      return {
                          ...room,
                          full_name: student.full_name || Teacher.full_name,
                          role: student.role || Teacher.role,
                          participantCount: participantCountMap[room.room_request_id] || 0 // ‚úÖ ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°
                      };
                  });

  
                    

                    console.log("‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß:", mergedData);
            
                    const tableBody = document.getElementById('reservation-table');
                    tableBody.innerHTML = '';
            
                    mergedData.forEach(row => {
                        tableBody.innerHTML += `
                            <tr>
                                 <td class="text-center">${new Date(row.submitted_time).toLocaleDateString('th')}</td>
                                <td class="text-center">${row.full_name}</td>
                                <td class="text-center">${row.role}</td>
                                <td class="text-center">${row.room_id}</td>
                                <td class="text-center">${row.participantCount}</td>
                                <td class="text-center">
                                    ${getDayOfWeek(row.used_date) + ' ' + new Date(row.used_date).toLocaleDateString('th')}<br>
                                    ${row.start_time.slice(0, 5) + ' - ' + row.end_time.slice(0, 5)}<br>
                                    ${'(' + row.request_type + ')'}
                                </td>
                                <td><button class="btn btn-danger btn-sm" onclick="updateStatus(${row.room_request_id}, '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button></td>
                            </tr>
                        `;
                    });

            
                } catch (error) {
                    console.error('‚ùå Error fetching data:', error);
                }
            }
            async function updateStatus(requestId, newStatus) {
              try {
                const response = await fetch('http://localhost:3000/updateStatus ', {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({ requestId, status: newStatus }),
                });
        
                if (response.ok) {
                   
                    fetchData(); // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
                } else {
                    const error = await response.json();
                    
                    alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞");
                }
            } catch (error) {
                console.error("‚ùå Error updating status:", error);
                alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ");
            }
        }
            
            document.addEventListener("DOMContentLoaded", fetchData);
                document.getElementById('detailModal').addEventListener('show.bs.modal', function (event) {
                    const button = event.relatedTarget;
                    document.getElementById('modal-date').textContent = button.getAttribute('data-date');
                    document.getElementById('modal-name').textContent = button.getAttribute('data-name');
                    document.getElementById('modal-room').textContent = button.getAttribute('data-room');
                    document.getElementById('modal-time').textContent = button.getAttribute('data-time');
                    document.getElementById('modal-reason').textContent = button.getAttribute('data-reason');
                });
                function getDayOfWeek(dateString) {
                  const days = ["‡∏≠‡∏≤.", "‡∏à.", "‡∏≠.", "‡∏û.", "‡∏û‡∏§.", "‡∏®.", "‡∏™."];
                  const date = new Date(dateString);
                  return days[date.getDay()];  // Returns 0-6 (0 = Sunday, 1 = Monday, ...)
              }
            
                fetchReservations();
              </script>
              <!-- ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ -->
            </tbody>
          </table>
        </div>
        <!-- /table-responsive -->
      </div>
    </div>

    <!-- !--fillter ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á -->
    <script>
      function filterTableRole(role) {
        const rows = document.querySelectorAll("#reservation-table tr");
      
        rows.forEach(row => {
          const roleCell = row.querySelector("td:nth-child(3)"); // ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
      
          if (!roleCell) return;
      
          const roleText = roleCell.textContent.trim();
      
          if (role === "‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î" || roleText === role) {
            row.style.display = "";
          } else {
            row.style.display = "none";
          }
        });
      }

      function filterTableRoom(room_id) {
        const rows = document.querySelectorAll("#reservation-table tr");

        rows.forEach(row => {
          const room_idCell = row.querySelector("td:nth-child(4)");

          if (!room_idCell) return;

          const room_idText = room_idCell.textContent.trim();

          if (room_id === "‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î" || room_idText === room_id) {
            row.style.display = "";
          } else {
            row.style.display = "none";
          }
        });
      }

    </script>
    
    <script> //‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏´‡πâ‡∏≠‡∏á
      
      fetch('http://localhost:3000/room_request')
        .then(response => response.json())
        .then(data => {
          const menu = document.getElementById('roomDropdownMenu');
    
          // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"
          const allItem = document.createElement('li');
          allItem.innerHTML = `<a class="dropdown-item" href="#" onclick="filterTableRoom('‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î')">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</a>`;
          menu.appendChild(allItem);
    
          // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≤‡∏Å database
          const allroom = [...new Set(data.map(item => item.room_id))];

          allroom.forEach(room_id => {
            const li = document.createElement('li');
            li.innerHTML = `<a class="dropdown-item" href="#" onclick="filterTableRoom('${room_id}')">${room_id}</a>`;
            menu.appendChild(li);

          
          });
        })
        .catch(error => console.error('Error fetching rooms:', error));
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      fetch("sidebar.html")
        .then((resp) => resp.text())
        .then((html) => {
          document.getElementById("sidebar-container").innerHTML = html;
        })
        .then(() => {
          // highlight ‡∏õ‡∏∏‡πà‡∏° "‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á"
          const btnStats = document.getElementById("btnReceive");
          btnStats.classList.add("btn-sidebar-active");
        })
        .catch((err) => console.error("Failed to load sidebar:", err));
    </script>
  </body>
</html>
