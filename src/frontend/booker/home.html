<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EasyRoom Reservation System - ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</title>
  <!-- Bootstrap 5 Bundle CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet" />
  <link href="styles.css" rel="stylesheet" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      padding: 0;
    }

    .header {
      background-color: #e54715;
      padding: 15px;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header-title {
      font-size: 25px;
      font-weight: bold;
    }

    .nav {
      display: flex;
      gap: 20px;
    }

    .nav a {
      color: white;
      text-decoration: none;
      font-size: 20px;
    }

    .nav a:hover {
      text-decoration: underline;
    }

    .nav a.active {
      font-weight: bold;
      text-decoration: underline;
    }

    .logout-btn {
      background-color: #5e1d78;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
    }

    .logout-btn:hover {
      background-color: #4b1561;
    }


    .user-info {
      background-color: #ffffff;
      margin: 0;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      width: 400px;
      max-width: 500px;
      flex-shrink: 0;
    }

    .user-avatar {
      font-size: 50px;
      margin-right: 20px;
    }

    .user-details div {
      margin-bottom: 8px;
    }

    .booking-section {
      background-color: #8e44ad;
      color: white;
      margin: 5px 0;
      /* ‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å auto ‡πÄ‡∏õ‡πá‡∏ô 0 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á */
      padding: 20px;
      border-radius: 10px;
      width: 100%;
      /* ‚úÖ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏ï‡πá‡∏° */
      max-width: none;
      /* ‚úÖ ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î 800px */
      box-sizing: border-box;
    }


    .booking-section h3 {
      margin-top: 0;
      font-size: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background-color: white;
      color: black;
      border-radius: 8px;
      overflow: hidden;
    }

    table th,
    table td {
      text-align: left;
      padding: 10px;
      border-bottom: 1px solid black;
    }

    table th {
      background-color: #dcdde1;
      color: #2c3e50;
      z-index: 2;
      position: sticky;
      top: 0;
    }

    table tr:nth-child(even) {
      background-color: #f2f2f2;
    }

    /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏´‡πâ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏°‡∏µ Scroll ‡∏¢‡πà‡∏≠‡∏¢ */
    .table-container {
      max-height: 400px;
      /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ç‡∏≠‡∏á Scroll (‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£) */
      overflow-y: auto;
      /* ‡πÄ‡∏û‡∏¥‡πà‡∏° Scroll ‡πÉ‡∏ô‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á */
      border: 1px solid #ccc;
      /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° */
      border-radius: 5px;
    }

    .status {
      color: green;
      font-weight: bold;
    }

    .cancel-btn {
      background-color: red;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
    }

    .cancel-btn:hover {
      background-color: darkred;
    }

    /* Modal Styling */
    #detailsModal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      width: 50%;
      padding: 20px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      border-radius: 8px;
      z-index: 1000;
    }

    /* ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á Overlay ‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏≤ */
    .modal-overlay {
      display: none;
      /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô */
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      /* ‡∏™‡∏µ‡∏î‡∏≥‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÅ‡∏™‡∏á */
      z-index: 999;
    }

    /* ‚úÖ ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á Modal ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á */
    .modal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 40%;
      max-width: 500px;
      background: white;
      padding: 20px;
      border-radius: 10px;
      z-index: 1000;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      text-align: center;
    }

    /* ‚úÖ ‡∏õ‡∏£‡∏±‡∏ö‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ "‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î" ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏≤ */
    .modal h3 {
      margin-top: 0;
      font-size: 24px;
      font-weight: bold;
      text-align: center;
    }

    /* ‚úÖ ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î (X) ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô */
    .close {
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 32px;
      font-weight: bold;
      color: rgb(0, 0, 0);
      background: none;
      border: none;
      cursor: pointer;
    }

    .close:hover {
      color: red;
    }

    /* ‚úÖ ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û */
    .modal img {
      width: 100%;
      max-width: 400px;
      margin-top: 10px;
      border-radius: 10px;
    }

    /* ‚úÖ ‡∏õ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Modal */
    .details-container {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 15px;
    }

    .details-row {
      display: flex;
      justify-content: space-between;
      background: #f5f5f5;
      padding: 10px;
      border-radius: 5px;
    }

    #repair-table-body tr {
      border: 1px solid red !important;
    }

    .details-row strong {
      color: #333;
    }

    /* Style ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Modal 
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
    }*/

    .modal-content {
      background-color: white;
      padding: 20px;
      border-radius: 8px;
      width: 50%;
      text-align: center;
    }

    .close-btn {
      position: absolute;
      top: 10px;
      right: 20px;
      font-size: 24px;
      cursor: pointer;
    }

    /* ‚úÖ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏†‡∏≤‡∏¢‡πÉ‡∏ô Modal ‡∏î‡∏π‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô */
    #detailsContainer {
      font-size: 18px;
      /* ‚úÖ ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô */
      font-weight: bold;
      /* ‚úÖ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏≤ */
      text-align: left;
      /* ‚úÖ ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏±‡∏î‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢ */
      margin-top: 10px;
    }

    /* ‡∏õ‡∏∏‡πà‡∏° "‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î" */
    .detail-btn {
      background-color: #007bff;
      color: white;
      padding: 5px 10px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .detail-btn:hover {
      background-color: #0056b3;
    }

    /* ‚úÖ ‡∏à‡∏±‡∏î modal ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡∏û‡∏≠‡∏î‡∏µ */
    #rejectModal.modal {
      display: none;
      position: fixed;
      top: 12 px;
      left: 16 px;
      transform: translate(-50%, -50%);
      background: white;
      padding: 20px 37px;
      border-radius: 12px;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);

      /* ‚úÖ ‡πÅ‡∏Å‡πâ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
      width: auto;
      min-width: 250px;
      max-width: 90vw;
      max-height: 80vh;
      overflow-y: auto;

      /* ‚úÖ ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡πÑ‡∏°‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô */
      height: auto;
    }



    /* ‚úÖ ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏ô modal */
    #rejectModal h3 {
      margin-top: 0;
      font-size: 22px;
      font-weight: bold;
      text-align: center;
      color: #333;
    }

    /* ‚úÖ ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢ + ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î */
    #rejectContent {
      text-align: left;
      font-size: 16px;
      line-height: 1.6;
      margin-top: 15px;
      color: #444;
    }

    /* ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î X */
    #rejectModal .close {
      position: absolute;
      top: 5px;
      right: 10px;
      font-size: 32px;
      font-weight: bold;
      color: #333;
      background: none;
      border: none;
      cursor: pointer;
    }

    #rejectModal .close:hover {
      color: red;
    }

    .main-layout {
      display: flex;
      gap: 20px;
      align-items: flex-start;
      padding: 20px;
    }

    .content-sections {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å ‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏≠‡πÅ‡∏Ñ‡∏ö‡∏Å‡∏ß‡πà‡∏≤ 992px */
    @media screen and (max-width: 992px) {
      .main-layout {
        flex-direction: column;
      }

      .user-info {
        width: 100%;
        margin-right: 0;
        margin-bottom: 20px;
      }

      .content-sections {
        width: 100%;
      }
    }

    .menu-toggle {
      font-size: 24px;
      background: none;
      color: white;
      border: none;
      cursor: pointer;
    }

    .mobile-popup-menu {
      position: absolute;
      top: 60px;
      right: 15px;
      background-color: white;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      display: none;
      flex-direction: column;
      gap: 10px;
      z-index: 1000;
    }

    .mobile-popup-menu a {
      color: #333;
      text-decoration: none;
    }

    .mobile-popup-menu a:hover {
      text-decoration: underline;
    }

    /* ‡πÄ‡∏û‡∏¥‡πà‡∏° Hover effect ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ñ‡∏ß‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á */
    table tbody tr {
      transition: background-color 0.3s ease, transform 0.2s ease;
      cursor: pointer;
    }

    table tbody tr:hover {
      background-color: #e9f5ff !important;
      transform: translateY(-2px);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    /* Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á */
    #bookingDetailsModal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      width: 600px;
      max-width: 90vw;
      padding: 30px;
      border-radius: 15px;
      z-index: 1001;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      color: #333;
    }

/* ‡πÅ‡∏•‡∏∞ CSS ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö Modal */
  </style>
</head>

<body>
  <nav class="navbar navbar-dark" style="background-color: #e54715;">
    <div class="container-fluid d-flex justify-content-between align-items-center">
      <span class="navbar-brand fw-bold text-white">EasyRoom Reservation System</span>

      <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏°‡∏Ç‡∏µ‡∏î (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠) -->
      <button class="menu-toggle d-lg-none" onclick="toggleMobileMenu()">‚ò∞</button>

      <!-- ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å (‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏à‡∏≠‡πÉ‡∏´‡∏ç‡πà) -->
      <div class="d-none d-lg-flex gap-3 align-items-center">
        <a class="nav-link text-white active" href="#">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        <a class="nav-link text-white" href="Floor2.html">‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á</a>
        <a class="nav-link text-white" href="repost.html">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</a>
        <button class="logout-btn ms-3" onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </div>
  </nav>

  <!-- ‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ö‡∏•‡∏≠‡∏¢ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ -->
  <div id="mobilePopupMenu" class="mobile-popup-menu d-lg-none">
    <a href="#">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
    <a href="Floor2.html">‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á</a>
    <a href="repost.html">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</a>
    <button class="logout-btn mt-2" onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
  </div>

  <!-- ‚úÖ ‡πÅ‡∏û‡πá‡∏Ñ user-info ‡πÅ‡∏•‡∏∞ sections ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô main-layout -->
  <div class="main-layout">
    <!-- ‡∏ã‡πâ‡∏≤‡∏¢: user info -->
    <div class="user-info">
      <div class="user-avatar">üòä</div>
      <div class="user-details">
        <div>‡∏ä‡∏∑‡πà‡∏≠ ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•: <span id="student-name">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span></div>
        <div>‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß: <span id="student-id">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span></div>
        <div>‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ: <span id="stud-year">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span></div>
        <div>‡∏Ñ‡∏ì‡∏∞: <span id="faculty">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span></div>
        <div>‡∏™‡∏≤‡∏Ç‡∏≤: <span id="department">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span></div>
      </div>
    </div>

    <!-- ‡∏Ç‡∏ß‡∏≤: section ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á -->
    <div class="content-sections">
      <!--‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á-->
      <section class="booking-section">
        <h3>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h3>
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                <th>‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á</th>
                <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</th>
                <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</th>
                <th>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°</th>
                <th>‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</th>
                <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="booking-table-body"></tbody>
          </table>
          <button id="load-more-btn" class="btn-load-more">‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</button>
        </div>
      </section>

      <!--‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤-->
      <section class="booking-section">
        <h3>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤</h3>
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°</th>
                <th>‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</th>
                <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
                <th>‡∏´‡πâ‡∏≠‡∏á</th>
                <th>‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°</th>
                <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                <th>‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="repair-table-body"></tbody>
          </table>
          <button class="btn-load-more">‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</button>
        </div>
      </section>
    </div>
  </div>
</body>


<!-- üìå Overlay ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á -->
<div id="modalOverlay" class="modal-overlay" onclick="closeDetailsModal()"></div>

<div id="detailsModal" class="modal">
  <span class="close" onclick="closeDetailsModal()">&times;</span>
  <h3 id="modalTitle">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°</h3>
  <div id="modalContent">
    <div id="imageContainer" class="image-container">
      <!-- ‚úÖ ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏ï‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
    </div>
    <div id="detailsContainer" class="details-container">
      <!-- ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
    </div>
  </div>
</div>

<!-- üìå Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ -->
<div id="rejectModal" class="modal">
  <span class="close" onclick="closeRejectModal()">&times;</span>
  <h3>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</h3>
  <div id="rejectContent" class="details-container"></div>
</div>


<script>
  function toggleMobileMenu() {
    const menu = document.getElementById("mobilePopupMenu");
    menu.style.display = menu.style.display === "flex" ? "none" : "flex";
  }

  // ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡πâ‡∏≤‡∏á‡∏ô‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏≤‡∏¢‡πÑ‡∏õ
  window.addEventListener("click", function (e) {
    const menu = document.getElementById("mobilePopupMenu");
    const button = document.querySelector(".menu-toggle");

    if (!menu.contains(e.target) && !button.contains(e.target)) {
      menu.style.display = "none";
    }
  });
  document.addEventListener("DOMContentLoaded", function () {
    let visibleRows = 10; // ‡πÅ‡∏™‡∏î‡∏á 10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏£‡∏Å
    const increment = 5; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏µ‡∏•‡∏∞ 5 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
    let tableRows;

    function updateTableVisibility() {
      let tableRows = document.querySelectorAll("#booking-table-body tr");
      tableRows.forEach((row, index) => {
        row.style.display = index < visibleRows ? "table-row" : "none";
      });

      // ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏ñ‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß
      document.getElementById("load-more-btn").style.display =
        visibleRows >= tableRows.length ? "none" : "block";
    }

    document
      .getElementById("load-more-btn")
      .addEventListener("click", function () {
        visibleRows += increment;
        updateTableVisibility();
      });

    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    fetchUserBookingData();

    function formatDate(isoString) {
      if (!isoString) return "-"; // ‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤
      return isoString.split("T")[0]; // ‡∏ï‡∏±‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡πà‡∏ß‡∏ô YYYY-MM-DD
    }

    async function fetchUserBookingData() {
      try {
        console.log("üîç ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á...");

        // ‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ã‡∏™‡∏ä‡∏±‡∏ô
        const sessionResponse = await fetch(
          "http://localhost:3000/session",
          {
            credentials: "include",
          }
        );
        if (!sessionResponse.ok)
          throw new Error("‚ùå ‡πÄ‡∏ã‡∏™‡∏ä‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà");

        const userSession = await sessionResponse.json();
        console.log("‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ã‡∏™‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ:", userSession);

        // ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö user_id
        const userId = userSession.data?.user_id;
        console.log("üéØ userId ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API:", userId);
        if (!userId) throw new Error("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö user_id");

        // ‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
        const response = await fetch(
          `http://localhost:3000/userBookings/${userId}`
        );
        if (!response.ok) throw new Error("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ");

        const bookings = await response.json();
        console.log("‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö:", bookings);

        // ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
        const tableBody = document.getElementById("booking-table-body");
        if (!tableBody) {
          console.error("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö element #booking-table-body");
          return;
        }

        tableBody.innerHTML = "";

        if (!Array.isArray(bookings) || bookings.length === 0) {
          console.warn("‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á");
          tableBody.innerHTML = `<tr><td colspan="8" style="text-align: center; color: red;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</td></tr>`;
          return;
        }

        // ‚úÖ ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ (‡πÉ‡∏´‡∏°‡πà‡∏™‡∏∏‡∏î ‚Üí ‡πÄ‡∏Å‡πà‡∏≤‡∏™‡∏∏‡∏î)
        bookings.sort(
          (a, b) => new Date(b.Submitted_date) - new Date(a.Submitted_date)
        );

        window.loadedBookingData = bookings;


        // ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ 10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏£‡∏Å
        bookings.forEach((booking) => {
          console.log(
            `üìå ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á: ‡∏´‡πâ‡∏≠‡∏á ${booking.room_name}, ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ ${booking.Submitted_date}, ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ ${booking.Used_date}`
          );

          const row = document.createElement("tr");
          row.setAttribute("data-id", booking.room_request_id);

          setTimeout(() => {
            document.querySelectorAll(".status").forEach(statusCell => {
              let statusText = statusCell.textContent.trim();
              console.log("üìå ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏µ:", statusText);
          
              if (statusText === "‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥") {
                statusCell.style.color = "green";
              } else if (statusText === "‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥" || statusText === "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á") {
                statusCell.style.color = "red";
              } else if (statusText === "‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥" || statusText === "‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£") {
                statusCell.style.color = "orange";
              }
            });
          }, 1000);

          // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å booking.request_status ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
          console.log("üìå request_status ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ:", booking.request_status);

          // ‡∏õ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô fetchUserBookingData()
        // ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ SQL ‡πÉ‡∏ô‡∏ù‡∏±‡πà‡∏á server.js ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ SQL ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß

        // ‡πÅ‡∏Å‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ - ‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô "‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£" ‡∏´‡∏£‡∏∑‡∏≠ "‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥" ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
        row.innerHTML = `
            <td>${booking.request_type || "-"}</td>
            <td>${booking.room_name || "-"}</td>
            <td>${formatDate(booking.Submitted_date) || "-"}</td>
            <td>${formatDate(booking.Used_date) || "-"}</td>
            <td>${booking.start_time || "-"}</td>
            <td>${booking.end_time || "-"}</td>
            <td class="status">${booking.request_status || "-"}</td>
            <td>
                ${booking.request_status === "‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£" || booking.request_status === "‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥"
                    ? `<button class="btn cancel-btn btn-sm" onclick="cancelBooking(${booking.room_request_id})">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>`
                    : booking.request_status === "‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥"
                        ? `<button class="btn detail-btn btn-sm" onclick="showRejectNote(${booking.room_request_id}, 'reject')">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</button>`
                        : booking.request_status === "‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥"
                            ? `<button class="btn detail-btn btn-sm" onclick="showRejectNote(${booking.room_request_id}, 'approve')">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</button>`
                            : "-"}
            </td>
        `;
          tableBody.appendChild(row);
        });

        updateTableVisibility();
      } catch (error) {
        console.error("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:", error);
        document.getElementById(
          "booking-table-body"
        ).innerHTML = `<tr><td colspan="8" style="text-align: center; color: red;">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>`;
      }
    }
  });

  async function fetchUserInfo() {
    try {
      const response = await fetch("http://localhost:3000/session", {
        method: "GET",
        credentials: "include",
      });

      if (!response.ok) {
        throw new Error("Session expired");
      }

      const userSession = await response.json();
      console.log("üîç ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå:", userSession);

      if (!userSession.data) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà");
        window.location.href = "login.html";
        return;
      }

      // ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
      document.getElementById("student-name").textContent =
        userSession.data.full_name;
      document.getElementById("student-id").textContent =
        userSession.data.student_id;
      document.getElementById("stud-year").textContent =
        userSession.data.Study_year;
      document.getElementById("faculty").textContent =
        userSession.data.Faculty;
      document.getElementById("department").textContent =
        userSession.data.Department;
    } catch (error) {
      console.error("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:", error);
      alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà");
      window.location.href = "login.html";
    }
  }

  async function logout() {
    try {
      const response = await fetch("http://localhost:3000/logout", {
        method: "POST",
        credentials: "include",
      });

      if (response.ok) {
        alert("‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
        window.location.href = "login.html";
      } else {
        alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö");
      }
    } catch (error) {
      console.error("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ:", error);
      alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà");
    }
  }
  async function fetchUserInfo() {
    try {
      const response = await fetch("http://localhost:3000/session", {
        method: "GET",
        credentials: "include",
      });

      if (!response.ok) {
        throw new Error("Session expired");
      }

      const userSession = await response.json();
      console.log("üîç ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå:", userSession);

      if (!userSession.data) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà");
        window.location.href = "login.html";
        return;
      }

      // ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö role ‡πÅ‡∏•‡∏∞‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á
      document.getElementById("student-name").textContent =
        userSession.data.full_name;
      document.getElementById("student-id").textContent =
        userSession.data.user_id; // ‡πÉ‡∏ä‡πâ user_id ‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏° student_id/teacher_id

      // ‚úÖ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏¥‡∏™‡∏¥‡∏ï ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤, ‡∏Ñ‡∏ì‡∏∞, ‡∏™‡∏≤‡∏Ç‡∏≤
      if (userSession.role === "‡∏ô‡∏¥‡∏™‡∏¥‡∏ï") {
        document.getElementById("stud-year").textContent =
          userSession.data.study_year || "-";
        document.getElementById("faculty").textContent =
          userSession.data.faculty || "-";
        document.getElementById("department").textContent =
          userSession.data.department || "-";
      } else {
        // ‚úÖ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå ‡πÉ‡∏´‡πâ‡∏ã‡πà‡∏≠‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤
        document.getElementById("stud-year").parentElement.style.display =
          "none";
        document.getElementById("faculty").textContent =
          userSession.data.faculty || "-";
        document.getElementById("department").textContent =
          userSession.data.department || "-";
      }
    } catch (error) {
      console.error("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:", error);
      alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà");
      window.location.href = "login.html";
    }
  }

  async function logout() {
    try {
      const response = await fetch("http://localhost:3000/logout", {
        method: "POST",
        credentials: "include",
      });

      if (response.ok) {
        alert("‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
        window.location.href = "login.html";
      } else {
        alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö");
      }
    } catch (error) {
      console.error("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ:", error);
      alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà");
    }
  }

  // ‚úÖ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏ã‡∏ô‡πÑ‡∏ó‡∏¢ (GMT+7)
  function convertToThaiTime(utcDate) {
    if (!utcDate) return "-";
    const date = new Date(utcDate);
    date.setHours(date.getHours() + 7); // ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô GMT+7
    return date.toISOString().slice(0, 10); // ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏Ñ‡πà YYYY-MM-DD
  }

  // ‚úÖ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏ã‡∏ô‡πÑ‡∏ó‡∏¢ (GMT+7)
  function convertToThaiTime(utcDate) {
    if (!utcDate) return "-";
    const date = new Date(utcDate);
    date.setHours(date.getHours() + 7); // ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô GMT+7
    return date.toISOString().slice(0, 10); // ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏Ñ‡πà YYYY-MM-DD
  }

  //‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‚ùå
  function showRejectNote(requestId, mode = "reject") {
    const bookings = window.loadedBookingData || [];
    const booking = bookings.find(b => b.room_request_id === requestId);
    if (!booking) {
      alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ");
      return;
    }

    let content = "";

    if (mode === "reject") {
      content = `
          <p><strong>üìç‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á : </strong> ${booking.room_name || "-"}</p>
          <p><strong>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ : </strong> ${booking.reject_reason || "-"}</p>
          <p><strong>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° : </strong> ${booking.detail_reject_reason || "-"}</p>
          <hr>
          <p><strong>üë§ ‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ :</strong> ${booking.admin_name || booking.executive_name}</p>
        `;
    } else if (mode === "approve") {
      content = `
          <p><strong>üìç‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á : </strong> ${booking.room_name || "-"}</p>
          <p><strong>üë§ ‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ : </strong> ${booking.admin_name || booking.executive_name}</p>
        `;
    }

    document.getElementById("rejectContent").innerHTML = content;
    document.getElementById("rejectModal").style.display = "block";
    document.getElementById("modalOverlay").style.display = "block";
  }



  function closeRejectModal() {
    document.getElementById("rejectModal").style.display = "none";
    document.getElementById("modalOverlay").style.display = "none";
  }

  //‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á
  async function cancelBooking(requestId) {
    console.log(`üîç ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á requestId ‡πÑ‡∏õ‡∏ó‡∏µ‡πà API: ${requestId}`);
  
    const row = document.querySelector(`tr[data-id="${requestId}"]`);
    if (!row) return;
  
    const statusCell = row.querySelector(".status");
    const statusText = statusCell.textContent.trim();
  
    // ‡πÅ‡∏Å‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£" ‡∏´‡∏£‡∏∑‡∏≠ "‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥" ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ
    if (statusText !== "‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£" && statusText !== "‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥") {
      alert("‚ùå ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' ‡∏´‡∏£‡∏∑‡∏≠ '‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥' ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô");
      return;
    }
  
    if (!confirm("‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) return;
  
    try {
      const response = await fetch(
        `http://localhost:3000/cancelBooking/${requestId}`,
        {
          method: "DELETE",
          headers: { "Content-Type": "application/json" },
        }
      );
  
      const result = await response.json();
      console.log("‚úÖ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå:", result);
  
      if (!response.ok)
        throw new Error(result.error || "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ");
  
      // ‡πÅ‡∏Å‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ - ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡πÅ‡∏ñ‡∏ß
      statusCell.textContent = "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á";
      statusCell.style.color = "red";
      
      // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏™‡∏î‡∏á "-"
      row.querySelector("td:last-child").innerHTML = "-";
  
      // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô loadedBookingData
      if (window.loadedBookingData) {
        const bookingIndex = window.loadedBookingData.findIndex(b => b.room_request_id === requestId);
        if (bookingIndex !== -1) {
          window.loadedBookingData[bookingIndex].request_status = "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á";
        }
      }
  
      alert("‚úÖ ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
    } catch (error) {
      console.error("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ:", error);
      alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà");
    }
  }

</script>
<script>
  async function fetchBrokenEquipments() {
    try {
      console.log("üîç ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API /getBrokenEquipments...");

      const response = await fetch("http://localhost:3000/getBrokenEquipments", {
        method: "GET",
        credentials: "include",
      });

      if (!response.ok) throw new Error("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏µ‡∏¢‡πÑ‡∏î‡πâ");

      const brokenEquipments = await response.json();
      console.log("‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å API:", brokenEquipments);

      const tableBody = document.getElementById("repair-table-body");
      if (!tableBody) {
        console.error("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö element #repair-table-body");
        return;
      }

      // ‚úÖ ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
      tableBody.innerHTML = "";

      if (!Array.isArray(brokenEquipments) || brokenEquipments.length === 0) {
        console.warn("‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á");
        tableBody.innerHTML = `<tr><td colspan="7" style="text-align: center;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°</td></tr>`;
        return;
      }

      // ‚úÖ ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
      brokenEquipments.forEach((item, index) => {
        console.log(`üìå ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà ${index + 1}:`, item);

        const row = document.createElement("tr");
        row.innerHTML = `
                  <td>${new Date(item.repair_date).toLocaleString("th-TH")}</td>
                  <td>${item.equipment_name || "-"}</td>
                  <td>${item.damage_details || "-"}</td>
                  <td>${item.room_id || "-"}</td>
                  <td>${item.Admin_Name}</td>
                  <td class="status">${item.repair_status || "-"}</td>
                  <td>
                      <button class="detail-btn" onclick="showDetails(${index}, 'repair')">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>
                  </td>

              `;
        tableBody.appendChild(row);
      });

      // ‚úÖ ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ global
      window.brokenEquipmentsData = brokenEquipments;

      console.log("‚úÖ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!");

    } catch (error) {
      console.error("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:", error);
    }
  }


  // ‚úÖ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
  document.addEventListener("DOMContentLoaded", fetchBrokenEquipments);






  function showDetails(index, type) {
    const modalTitle = document.getElementById("modalTitle");
    const detailsContainer = document.getElementById("detailsContainer");

    if (!modalTitle || !detailsContainer) {
      console.error("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö element #modalTitle ‡∏´‡∏£‡∏∑‡∏≠ #detailsContainer");
      return;
    }

    let detailsContent = "";

    if (type === "repair") {
      const item = window.brokenEquipmentsData[index];

      // ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏°‡∏≤
      console.log("üìå ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏°‡∏≤:", item);

      if (!item) {
        console.error("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö index:", index);
        return;
      }

      // ‚úÖ ‡∏î‡∏∂‡∏á path ‡∏Ç‡∏≠‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å API
      let imageUrl = item.image_path ? `http://localhost:3000/image/${item.image_path}` : "";

      modalTitle.innerText = "‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°";
      detailsContent = `
            ${imageUrl ? `<img src="${imageUrl}" alt="‡∏†‡∏≤‡∏û‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢" style="width: 100%; max-width: 400px; border-radius: 8px; margin-top: 10px;">` : ""}
            <p><strong>üñ• ‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå:</strong> ${item.equipment_name || "-"}</p>
            <p><strong>üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°:</strong> ${item.damage || "-"}</p>
            <p><strong>üîç ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°:</strong> ${item.damage_details || "-"}</p>
            <p><strong>üìç ‡∏´‡πâ‡∏≠‡∏á:</strong> ${item.room_id || "-"}</p>
            <p><strong>‚ö†Ô∏è ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ${item.repair_status || "-"}</p>
            <p><strong>üë§ ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°:</strong> ${item.Admin_Name || "‡∏£‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°"}</p>
            <p><strong>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°:</strong> ${new Date(item.repair_date).toLocaleString("th-TH")}</p>
        `;

      console.log("üìù HTML ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏™‡∏î‡∏á:", detailsContent);
    }

    detailsContainer.innerHTML = detailsContent;
    document.getElementById("modalOverlay").style.display = "block";
    document.getElementById("detailsModal").style.display = "block";
  }

  async function loadBrokenEquipments() {
    try {
      const response = await fetch("http://localhost:3000/getBrokenEquipments");
      if (!response.ok) throw new Error("‚ùå ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ä‡∏≥‡∏£‡∏∏‡∏î‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß");

      const data = await response.json();
      console.log("‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡πÑ‡∏î‡πâ:", data);

      // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà window ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ showDetails() ‡πÉ‡∏ä‡πâ
      window.brokenEquipmentsData = data;

    } catch (error) {
      console.error("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:", error);
    }
  }

  // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
  document.addEventListener("DOMContentLoaded", loadBrokenEquipments);



  function closeDetailsModal() {
    document.getElementById("modalOverlay").style.display = "none";
    document.getElementById("detailsModal").style.display = "none";
  }








  function openDetailsModal(index) {
    console.log("üìå ‡πÄ‡∏õ‡∏¥‡∏î Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö index:", index);

    if (
      !window.brokenEquipmentsData ||
      !window.brokenEquipmentsData[index]
    ) {
      console.error("‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö index:", index);
      return;
    }

    const item = window.brokenEquipmentsData[index];

    console.log("üìå ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏°‡∏≤:", item);

    const repairDate = new Date(item.Repair_date).toLocaleString("th-TH", {
      year: "numeric",
      month: "2-digit",
      day: "2-digit",
      hour: "2-digit",
      minute: "2-digit",
      second: "2-digit",
    });

    const detailsContainer = document.getElementById("detailsContainer");
    detailsContainer.innerHTML = `
        <div class="details-container">
            <div class="details-row"><strong>‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á:</strong> ${item.Admin_Name}</div>
            <div class="details-row"><strong>‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°:</strong> ${repairDate}</div>
            <div class="details-row"><strong>‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå:</strong> ${item.Equipments_name}</div>
            <div class="details-row"><strong>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î:</strong> ${item.Damaged_details}</div>
            <div class="details-row"><strong>‡∏´‡πâ‡∏≠‡∏á:</strong> SC2-${item.Rooms_ID}</div>
            <div class="details-row"><strong>‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°:</strong> ${item.Admin_Name}</div>
            <div class="details-row"><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ${item.Repair_status}</div>
        </div>
    `;

    console.log(
      "üìå HTML ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô Modal:",
      detailsContainer.innerHTML
    );

    document.getElementById("modalOverlay").style.display = "block";
    document.getElementById("detailsModal").style.display = "block";
  }

  function closeDetailsModal() {
    console.log("üìå ‡∏õ‡∏¥‡∏î Modal"); // Debugging Log
    document.getElementById("modalOverlay").style.display = "none";
    document.getElementById("detailsModal").style.display = "none";
  }

  window.onload = function () {
    fetchUserInfo();
    fetchUserBookingData();
    fetchBrokenEquipments();
  };
  console.log("üìå HTML ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô Modal:", detailsContainer.innerHTML);
</script>
<!-- Bootstrap 5 JavaScript (‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ navbar toggle ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>