<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: "TH SarabunPSK", sans-serif;
            font-size: 16px;
            background-color: #f9f9f9;
        }

        .form-title {
            text-align: center;
            font-weight: bold;
            font-size: 20px;
            margin-bottom: 15px;
        }

        .form-label {
            font-weight: bold;
            font-size: 16px;
        }

        input[readonly],
        select {
            background-color: #e9ecef;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 14px;
            padding: 5px;
            height: auto;
        }

        .table {
            margin-top: 5px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 1001;
            padding: 20px;
            text-align: center;
        }

        .modal.active {
            display: block;
        }

        .table th {
            background-color: #f2f2f2;
            text-align: center;
            vertical-align: middle;
            font-size: 14px;
            border: 1px solid #dee2e6;
            padding: 5px;
        }

        .table td {
            padding: 5px;
            text-align: center;
            vertical-align: middle;
            border: 1px solid #dee2e6;
            height: 30px;
            font-size: 14px;
        }

        .table td span {
            display: inline-block;
            width: 100%;
            background-color: transparent;
            text-align: center;
        }

        .row-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }

        h5 {
            font-weight: bold;
            font-size: 16px;
            margin: 0;
        }

        .btn-add {
            font-size: 20px;
            color: #6a1b9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .btn-add:hover {
            color: #ff5722;
        }

        .menu-icon {
            cursor: pointer;
            color: #6a1b9a;
            font-size: 20px;
            position: absolute;
            top: 15px;
            left: 15px;
        }

        .btn-confirm {
            background-color: #ff5722;
            color: white;
            font-size: 16px;
            border: none;
            padding: 8px 15px;
        }

        .btn-confirm:hover {
            background-color: #e64a19;
        }

        .textarea-container {
            margin-top: 15px;
        }

        .textarea-container label {
            font-size: 16px;
        }

        .textarea-row {
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .textarea-row textarea {
            flex: 1;
            max-width: calc(100% - 120px);
            height: 50px;
        }

        .textarea-row .btn-confirm {
            flex-shrink: 0;
            margin-top: 0;
            margin-left: auto;
        }

        .note {
            font-size: 14px;
            color: gray;
            margin-top: 10px;
            text-align: center;
        }

        .sidebar {
            position: fixed;
            top: 0;
            left: -250px;
            width: 250px;
            height: 100%;
            background-color: #ff5722;
            color: white;
            padding: 15px;
            transition: left 0.3s ease;
            z-index: 1000;
        }

        .sidebar.active {
            left: 0;
        }

        .sidebar h4 {
            color: white;
            font-size: 18px;
            margin-bottom: 15px;
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }

        .overlay.active {
            display: block;
        }
    </style>
</head>

<body>
    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏°‡∏Ç‡∏µ‡∏î -->
    <div class="menu-icon" onclick="toggleSidebar()">&#9776;</div>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="radio-container">
            <h4>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h4>
            <label>
                <input type="radio" name="booking-type" value="‡∏ô‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤">
                ‡∏ô‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤
            </label><br>
            <label>
                <input type="radio" name="booking-type" value="‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤" checked>
                ‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤
            </label>
        </div>
    </div>

    <!-- Overlay -->
    <div class="overlay" id="overlay" onclick="closeSidebarOrModal()"></div>

    <!-- Modal -->
    <div class="modal" id="modal">
        <h5>‡∏¢‡∏∑‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ‡∏´‡πâ‡∏≠‡∏á SC2-308</h5>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</th>
                    <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>‡∏™‡∏≤‡∏¢ console</td>
                    <td><input type="number" min="0" class="form-control form-control-sm" value="0"></td>
                </tr>
                <tr>
                    <td>‡∏™‡∏≤‡∏¢ lan cat5</td>
                    <td><input type="number" min="0" class="form-control form-control-sm" value="0"></td>
                </tr>
                <tr>
                    <td>‡∏™‡∏≤‡∏¢ crossover</td>
                    <td><input type="number" min="0" class="form-control form-control-sm" value="0"></td>
                </tr>
                <tr>
                    <td>hub</td>
                    <td><input type="number" min="0" class="form-control form-control-sm" value="0"></td>
                </tr>
                <tr>
                    <td>router</td>
                    <td><input type="number" min="0" class="form-control form-control-sm" value="1"></td>
                </tr>
                <tr>
                    <td>switch</td>
                    <td><input type="number" min="0" class="form-control form-control-sm" value="2"></td>
                </tr>
                <tr>
                    <td>‡∏≠‡∏∑‡πà‡∏ô‡πÜ</td>
                    <td><input type="number" min="0" class="form-control form-control-sm" value="0"></td>
                </tr>
            </tbody>
        </table>
        <button type="button" class="btn-confirm" onclick="saveData()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
    </div>

    


    <div class="container mt-4">
        <h4 class="form-title">‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤</h4>
        <form method="GET" action="submit_booking.php"> <!-- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î action ‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÑ‡∏õxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
            <div class="row mb-3">
                <div class="col-md-6">
                    <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                    <input type="text" class="form-control" id="teacher-name" value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î..." readonly>
                </div>
                <div class="col-md-6">
                    <label class="form-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</label>
                    <input type="text" class="form-control" id="phone-number" value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î..." readonly>
                </div>

            </div>
            <div class="row mb-3">

            </div>
            <div class="row-header">
                <h5>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h5>
            </div>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡πâ‡∏≠‡∏á</th>
                        <th>‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á</th>
                        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á</th>
                        <th>‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td id="room-type-info">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</td>
                        <td id="room-info">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</td>
                        <td id="booking-date-info">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</td>
                        <td id="time-range-info">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</td>
                    </tr>
                </tbody>
            </table>            
            <div class="row-header">
                <h5 class="mt-4">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°</h5>
                <button type="button" class="btn-add" onclick="openModal()">+</button>
            </div>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</th>
                        <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                    </tr>
                </thead>
                <tbody id="equipment-table-body">
                    <!-- ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                </tbody>
            </table>
            
            <h5>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏° (‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)</h5>
            <table class="table table-bordered">
            <thead>
                <tr>
                <th>‡πÅ‡∏ñ‡∏ß</th>
                <th>‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á</th>
                </tr>
            </thead>
            <tbody id="computer-table-body">
                <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
            </tbody>
            </table>

            <div class="textarea-container">
                <label class="form-label">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á</label>
                <div class="textarea-row">
                  <select class="form-select" name="usage">
                    <option value="‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠">
                      ‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠
                    </option>
                    <option value="‡∏Ç‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏á‡∏≤‡∏ô">
                      ‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
                    </option>
                    <option value="‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏ß‡∏¥‡∏à‡∏±‡∏¢">
                      ‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏ß‡∏¥‡∏à‡∏±‡∏¢
                    </option>
                    <option value="‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ">
                      ‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ
                    </option>
                    <option value="‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ä‡∏°‡∏£‡∏°">
                      ‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ä‡∏°‡∏£‡∏°
                    </option>
                    <option value="‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå">
                      ‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå
                    </option>
                    <option value="‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≥‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠">
                      ‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≥‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠
                    </option>
                    <option value="‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏≠‡∏∑‡πà‡∏ô ‡πÜ">
                      ‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏≠‡∏∑‡πà‡∏ô ‡πÜ
                    </option>
                  </select>
                </div>
                <br/>
                <div class="mb-3">
                  <label for="additional-details" class="form-label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
                  <textarea id="additional-details" class="form-control" rows="3" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..."></textarea>
                </div>
                <!-- <button
                  class="btn-confirm"
                  type="button"
                  style="margin-left: auto; display: block"
                  onclick="submitBooking(); window.location.href='home.html'"
                >
                  ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
                </button> -->
                <button class="btn-confirm" type="button" style="margin-left: auto; display: block"
                    onclick="submitBookingA()">
                    ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
                </button>
              </div>
            </div>
            <p class="note">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏Ñ‡∏ß‡∏¥‡∏ä‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏Ø ‡∏Ñ‡∏ì‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ô‡πÄ‡∏£‡∏®‡∏ß‡∏£ ‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå ‡∏ñ‡∏∂‡∏á ‡∏®‡∏∏‡∏Å‡∏£‡πå ‡πÄ‡∏ß‡∏•‡∏≤ 8.00 - 17.00 ‡∏ô. ‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå</p>
        </form>
    </div>

    <script>
        async function fetchTeacherInfo() {
            try {
              const response = await fetch("http://localhost:3000/session", {
                credentials: "include"
              });
              const sessionData = await response.json();
              if (!sessionData.data) {
                alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà");
                window.location.href = "login.html";
                return;
              }
              console.log("‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô‡∏à‡∏≤‡∏Å session:", sessionData.data);
          
              // ‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°
              document.getElementById("teacher-name").value =
                sessionData.data.full_name || "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
              document.getElementById("phone-number").value =
                sessionData.data.phone_number || "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
              
              // ‡∏Ø‡∏•‡∏Ø
            } catch (error) {
              console.error("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô:", error);
            }
          }
          async function loadEquipmentMapping() {
            let equipmentMapping = {};
            try {
                const response = await fetch("http://localhost:3000/getEquipmentInformation");
                if (!response.ok) throw new Error("HTTP error " + response.status);
                
                const equipData = await response.json();
                console.log("‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏à‡∏≤‡∏Å API:", equipData);
        
                // ‡πÅ‡∏°‡∏õ‡∏Ñ‡πà‡∏≤ equipment_id -> equipment_name
                equipData.forEach((item) => {
                    equipmentMapping[item.equipment_id] = item.equipment_name;
                });
        
            } catch (err) {
                console.error("‚ùå Error fetching equipment information:", err);
            }
            return equipmentMapping;
        }
        
        //‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        async function submitBookingA() {
            const urlParams = new URLSearchParams(window.location.search);
            const room_id = urlParams.get("room");
            const used_date = urlParams.get("date");
            const start_time = urlParams.get("startTime");
            const end_time = urlParams.get("endTime");
    
            const request_type = window.location.pathname.includes("TimeOut") ? "‡∏ô‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤" : "‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤";
            const request_reason = document.querySelector("select[name='usage']").value;
            const detail_request_reason = document.getElementById("additional-details").value || null;
    
            // ‚úÖ ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡πÇ‡∏ï‡πä‡∏∞‡∏Ñ‡∏≠‡∏°‡∏à‡∏≤‡∏Å URL
            const desks = urlParams.get("desks") ? urlParams.get("desks").split(",").map(Number) : [];
    
            // ‚úÖ ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏à‡∏≤‡∏Å URL
            const equipments = urlParams.get("equipments") || "";
    
            // ‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏° (‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö TimeInTeacher)
            const teacher_name = document.getElementById("teacher-name").value || null;
            const phone_number = document.getElementById("phone-number").value || null;

    
            if (!room_id || !used_date || !start_time || !end_time || !request_reason) {
                alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");
                return;
            }
    
            console.log("üìå ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡πÑ‡∏õ API:", {
                room_id, used_date, start_time, end_time, request_type, request_reason, detail_request_reason,
                desks, equipments, teacher_name, phone_number
            });
    
            try {
                const response = await fetch("http://localhost:3000/submitBookingA", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    credentials: "include",
                    body: JSON.stringify({
                        room_id, used_date, start_time, end_time,
                        request_type, request_reason, detail_request_reason, desks, equipments,
                        teacher_name, phone_number
                    })
                });
    
                const result = await response.json();
                console.log("üìå ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å API:", result);
    
                if (result.success) {
                    alert("‚úÖ ‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
                    window.location.href = "home.html";
                } else {
                    alert("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + result.error);
                }
            } catch (error) {
                console.error("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:", error);
                alert("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ");
            }
        }
        
        
        
        

        async function loadEquipmentDetails() {
            console.log("üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå...");
        
            // ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏à‡∏≤‡∏Å URL
            const urlParams = new URLSearchParams(window.location.search);
            const equipmentsParam = urlParams.get("equipments"); // ‡πÄ‡∏ä‡πà‡∏ô "12:1,13:2"
        
            console.log("üìå Equipments Param:", equipmentsParam);
        
            if (!equipmentsParam) {
                console.warn("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ñ‡πà‡∏≤‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏à‡∏≤‡∏Å URL");
                return;
            }
        
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏à‡∏≤‡∏Å API
            const equipmentMapping = await loadEquipmentMapping();
            
            let equipmentTableRows = "";
            const equipmentItems = equipmentsParam.split(",");
            
            equipmentItems.forEach((item) => {
                const [id, amount] = item.split(":");
                const name = equipmentMapping[id] || `‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (${id})`;
                equipmentTableRows += `<tr>
                    <td>${name}</td>
                    <td>${amount}</td>
                </tr>`;
            });
        
            console.log("‚úÖ ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:", equipmentTableRows);
            
            document.getElementById("equipment-table-body").innerHTML = equipmentTableRows;
        }
        document.addEventListener("DOMContentLoaded", async function () {
            await loadEquipmentDetails();
        });
                
          
    
        // ‚úÖ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
        window.onload = function() {
            setTimeout(fetchTeacherInfo, 500); // ‡∏£‡∏≠ 0.5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        };
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            sidebar.classList.toggle('active');
            overlay.classList.add('active');
        }

        function openModal() {
            const modal = document.getElementById('modal');
            const overlay = document.getElementById('overlay');
            modal.classList.add('active');
            overlay.classList.add('active');
        }

        function closeSidebarOrModal() {
            const sidebar = document.getElementById('sidebar');
            const modal = document.getElementById('modal');
            const overlay = document.getElementById('overlay');

            if (sidebar.classList.contains('active')) {
                sidebar.classList.remove('active');
            }

            if (modal.classList.contains('active')) {
                modal.classList.remove('active');
            }

            overlay.classList.remove('active');
        }

        function saveData() {
            const modal = document.getElementById('modal');
            const rows = document.querySelectorAll('#modal tbody tr');
            const tableBody = document.querySelector('.table.table-bordered:nth-of-type(2) tbody');

            rows.forEach((row) => {
                const equipmentName = row.cells[0].innerText;
                const equipmentQty = parseInt(row.cells[1].querySelector('input').value);

                let existingRow = Array.from(tableBody.rows).find(r => r.cells[0].innerText === equipmentName);

                if (equipmentQty > 0) {
                    if (existingRow) {
                        existingRow.cells[2].innerText = equipmentQty;
                    } else {
                        const newRow = document.createElement('tr');

                        const nameCell = document.createElement('td');
                        nameCell.innerText = equipmentName;
                        newRow.appendChild(nameCell);

                        const roomCell = document.createElement('td');
                        roomCell.innerText = 'SC2-308';
                        newRow.appendChild(roomCell);

                        const qtyCell = document.createElement('td');
                        qtyCell.innerText = equipmentQty;
                        newRow.appendChild(qtyCell);

                        tableBody.appendChild(newRow);
                    }
                } else if (existingRow) {
                    tableBody.removeChild(existingRow);
                }
            });

            modal.classList.remove('active');
            closeSidebarOrModal();
        }
        // ‚úÖ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà YYYY-MM-DD ‚Üí DD/MM/YYYY
        function formatDateForDisplay(dateStr) {
            if (!dateStr) return "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
            const parts = dateStr.split("-");
            return `${parts[2]}/${parts[1]}/${parts[0]}`; // 2025-02-27 ‚Üí 27/02/2025
        }

        async function loadRoomDetails(roomId) {
            try {
                const response = await fetch("http://localhost:3000/roomdetail");
                if (!response.ok) throw new Error("HTTP error " + response.status);
                const rooms = await response.json();

                // ‡∏´‡∏≤ room ‡∏ó‡∏µ‡πà room_id ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö roomParam
                const roomDetail = rooms.find((room) => room.room_id == roomId);
                console.log("‚úÖ Room Detail:", roomDetail);

                if (roomDetail) {
                    document.getElementById("room-info").textContent = roomDetail.room_name || "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
                    document.getElementById("room-type-info").textContent = roomDetail.room_type || "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
                } else {
                    document.getElementById("room-info").textContent = "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
                    document.getElementById("room-type-info").textContent = "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
                }
            } catch (err) {
                console.error("‚ùå Error fetching room details:", err);
                document.getElementById("room-info").textContent = "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
                document.getElementById("room-type-info").textContent = "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
            }
        }
        
        function displaySelectedComputers() {
            const urlParams = new URLSearchParams(window.location.search);
            const desksParam = urlParams.get("desks"); // ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ desks
            const computerTableBody = document.getElementById("computer-table-body");
          
            if (!desksParam) {
              computerTableBody.innerHTML = `<tr><td colspan="3">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</td></tr>`;
              return;
            }
          
            const deskItems = desksParam.split(",");
            const rowPattern = [3, 4, 3]; // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÅ‡∏ñ‡∏ß 3 - 4 - 3
            let computerTableRows = "";
            let startIndex = 0;
          
            for (let i = 0; startIndex < deskItems.length; i++) {
              const count = rowPattern[i % rowPattern.length]; // ‡∏ß‡∏ô‡∏ã‡πâ‡∏≥ pattern
              const rowItems = deskItems.slice(startIndex, startIndex + count);
          
              if (rowItems.length > 0) {
                computerTableRows += `<tr>
                  <td>‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà ${i + 1}</td>
                  <td>${rowItems.map((desk) => `${desk}`).join(", ")}</td>
                </tr>`;
              }
          
              startIndex += count;
            }
          
            computerTableBody.innerHTML = computerTableRows;
          }

        // ‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏´‡∏•‡∏î
        document.addEventListener("DOMContentLoaded", async function () {
            const urlParams = new URLSearchParams(window.location.search);
            const roomParam = urlParams.get("room"); // ‡πÄ‡∏ä‡πà‡∏ô "307"
            const dateParam = urlParams.get("date"); // ‡πÄ‡∏ä‡πà‡∏ô "2025-02-27"
            const startTimeParam = urlParams.get("startTime"); // ‡πÄ‡∏ä‡πà‡∏ô "12:00:00"
            const endTimeParam = urlParams.get("endTime"); // ‡πÄ‡∏ä‡πà‡∏ô "13:00:00"
            const desksParam = urlParams.get("desks");

            console.log("üìå Room Param from URL:", roomParam);
            console.log("üìå Date Param from URL:", dateParam);

            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≠‡∏á
            await loadRoomDetails(roomParam);

            displaySelectedComputers(desksParam);

            // ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á
            document.getElementById("booking-date-info").textContent = formatDateForDisplay(dateParam);

            // ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á
            const formattedStartTime = formatTimeForDisplay(startTimeParam);
            const formattedEndTime = formatTimeForDisplay(endTimeParam);
            document.getElementById("time-range-info").textContent = `${formattedStartTime}-${formattedEndTime} ‡∏ô.`;
        });

        // ‚úÖ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á 12.00 ‡∏ô. ‡πÅ‡∏ó‡∏ô 12:00:00
        function formatTimeForDisplay(timeStr) {
            if (!timeStr) return "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
            const parts = timeStr.split(":");
            return `${parseInt(parts[0], 10)}.${parts[1]}`;
        }
        

        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡∏≠‡∏á Radio Button
        document.querySelectorAll('input[name="booking-type"]').forEach(function(radio) {
            radio.addEventListener('change', function() {
                if (this.value === '‡∏ô‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤') {
                    // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏ô‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤" ‡πÉ‡∏´‡πâ‡πÑ‡∏õ‡∏ó‡∏µ‡πà TimeOut2Teacher.html
                    window.location.href = './TimeOut3Teacher.html';
                } else if (this.value === '‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤') {
                    // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤" ‡πÉ‡∏´‡πâ‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ
                    window.location.href = './TimeInTeacher.html';
                }
            });
        });
    </script>
</body>

</html>